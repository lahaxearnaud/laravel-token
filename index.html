<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Laravel-token by lahaxearnaud</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Laravel-token</h1>
        <p class="header"></p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/lahaxearnaud/laravel-token/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/lahaxearnaud/laravel-token/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/lahaxearnaud/laravel-token">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/lahaxearnaud">lahaxearnaud</a></p>


      </header>
      <section>
        <h1>
<a id="laravel-token" class="anchor" href="#laravel-token" aria-hidden="true"><span class="octicon octicon-link"></span></a>Laravel token</h1>

<p><a href="https://travis-ci.org/lahaxearnaud/laravel-token"><img src="https://travis-ci.org/lahaxearnaud/laravel-token.svg?branch=develop" alt="Build Status"></a>
<a href="https://insight.sensiolabs.com/projects/2f9abd1c-42a6-4a80-88f4-e1687b1d361a"><img src="https://insight.sensiolabs.com/projects/2f9abd1c-42a6-4a80-88f4-e1687b1d361a/mini.png" alt="SensioLabsInsight"></a>
<a href="https://codeclimate.com/github/lahaxearnaud/laravel-token"><img src="https://d3s6mut3hikguw.cloudfront.net/github/lahaxearnaud/laravel-token/badges/gpa.svg" alt="CodeClimat"></a>
<a href="https://codeclimate.com/github/lahaxearnaud/laravel-token"><img src="https://codeclimate.com/github/lahaxearnaud/laravel-token/badges/coverage.svg" alt="Test Coverage"></a>
<a href="https://github.com/lahaxearnaud/cook-bookmarks"><img src="https://poser.pugx.org/leaphly/cart-bundle/license.svg" alt="License"></a></p>

<h2>
<a id="table-of-contents" class="anchor" href="#table-of-contents" aria-hidden="true"><span class="octicon octicon-link"></span></a>Table of Contents</h2>

<ul>
<li>
<a href="#installation">Installation</a>

<ul>
<li><a href="#database">Database</a></li>
<li><a href="#provider">Provider</a></li>
<li><a href="#facase">Facase</a></li>
</ul>
</li>
<li>
<a href="#usage">Usage</a>

<ul>
<li><a href="#create-token">Create token</a></li>
<li><a href="#crypt-token">Crypt token</a></li>
<li><a href="#validate-token">Validate token</a></li>
</ul>
</li>
<li>
<a href="#api">API</a>

<ul>
<li><a href="#security">Security</a></li>
<li><a href="#creation">Creation</a></li>
<li><a href="#deletion">Deletion</a></li>
<li><a href="#validation">Validation</a></li>
<li><a href="#find">Find</a></li>
</ul>
</li>
</ul>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h2>

<pre><code>{
    "require": {
        "lahaxearnaud/laravel-token": "~0.1"
    }
}
</code></pre>

<h3>
<a id="database" class="anchor" href="#database" aria-hidden="true"><span class="octicon octicon-link"></span></a>Database</h3>

<h3>
<a id="provider" class="anchor" href="#provider" aria-hidden="true"><span class="octicon octicon-link"></span></a>Provider</h3>

<pre><code>    'providers' =&gt; array(
        // ...
        'Lahaxearnaud\LaravelToken\LaravelTokenServiceProvider',
    ),
</code></pre>

<h3>
<a id="facase" class="anchor" href="#facase" aria-hidden="true"><span class="octicon octicon-link"></span></a>Facase</h3>

<pre><code>    'aliases' =&gt; array(
        // ...
        'Token' =&gt; 'Lahaxearnaud\LaravelToken\LaravelTokenFacade',
    ),
</code></pre>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h2>

<h3>
<a id="create-token" class="anchor" href="#create-token" aria-hidden="true"><span class="octicon octicon-link"></span></a>Create token</h3>

<pre><code>    $token = Token::create($userID);
</code></pre>

<h3>
<a id="crypt-token" class="anchor" href="#crypt-token" aria-hidden="true"><span class="octicon octicon-link"></span></a>Crypt token</h3>

<pre><code>    $token = Token::create($userID);
    $cryptToken = Token::cryptToken($token-&gt;token);
</code></pre>

<h3>
<a id="validate-token" class="anchor" href="#validate-token" aria-hidden="true"><span class="octicon octicon-link"></span></a>Validate token</h3>

<p>If you crypt your token</p>

<pre><code>    $tokenStr = Input::get('token');

    $cryptToken = Token::isValidCryptToken($token-&gt;token, $userId);
</code></pre>

<p>If you don't crypt your token:</p>

<pre><code>    $tokenStr = Input::get('token');

    $cryptToken = Token::isValidToken($token-&gt;token, $userId);
</code></pre>

<p>If you use those functions the token is not burn. It can be use many times.</p>

<p>For one shot usage token:</p>

<pre><code>    $tokenStr = Input::get('token');

    /**
      * if the token is crypt do :
      * $tokenStr = Token::uncryptToken($tokenStr);
    **/

    $tokenValid = true;
    try {
        // find the token
        $token = $token-&gt;findByToken($tokenStr, $userId);

        // test the token validity
        if (Token::isValidToken($token)) {

            // do what you need to do

            // delete the token
            Token::burn($token);
        } else {
            $tokenValid = false;
        }
    } catch (ModelNotFoundException $e) {
        $tokenValid = false;
    }

    if($tokenValid) {
        // manage errors
    }
</code></pre>

<h2>
<a id="api" class="anchor" href="#api" aria-hidden="true"><span class="octicon octicon-link"></span></a>API</h2>

<h3>
<a id="security" class="anchor" href="#security" aria-hidden="true"><span class="octicon octicon-link"></span></a>Security</h3>

<p>Crypt a string token</p>

<pre><code>    public function cryptToken ($uncrypt)
</code></pre>

<p>Uncrypt a string token</p>

<pre><code>    public function uncryptToken ($crypt)
</code></pre>

<h3>
<a id="creation" class="anchor" href="#creation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Creation</h3>

<p>Create a Token instance</p>

<pre><code>    public function create ($userId, $lifetime = 3600, $length = 100)
</code></pre>

<p>Insert the token in database</p>

<pre><code>    public function persist (Token $token)
</code></pre>

<h3>
<a id="deletion" class="anchor" href="#deletion" aria-hidden="true"><span class="octicon octicon-link"></span></a>Deletion</h3>

<p>Delete the token</p>

<pre><code>    public function burn (Token $token)
</code></pre>

<h3>
<a id="validation" class="anchor" href="#validation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Validation</h3>

<p>Fetch the token, check id the token has the good user ID and if it is not expired</p>

<pre><code>    public function isValidToken ($token, $userId)
</code></pre>

<p>Same as isValidToken but uncrypt the token before trying to find him</p>

<pre><code>    public function isValidCryptToken ($token, $userId)
</code></pre>

<p>Only validate if the token is expired</p>

<pre><code>    public function isValid (Token $token)
</code></pre>

<h3>
<a id="find" class="anchor" href="#find" aria-hidden="true"><span class="octicon octicon-link"></span></a>Find</h3>

<p>Find the token by ID</p>

<pre><code>    public function find ($id)
</code></pre>

<p>Find the token by token string</p>

<pre><code>    public function findByToken ($token, $userId)
</code></pre>

<p>Find all token for an user</p>

<pre><code>    public function findByUser ($idUser)
</code></pre>
      </section>
      <footer>
        <p><small>Hosted on <a href="http://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		
  </body>
</html>
