<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Laravel-token by lahaxearnaud</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Laravel-token</h1>
        <h2></h2>
        <a href="https://github.com/lahaxearnaud/laravel-token" class="button"><small>View project on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>
<a id="laravel-token" class="anchor" href="#laravel-token" aria-hidden="true"><span class="octicon octicon-link"></span></a>Laravel token</h1>

<p><a href="https://travis-ci.org/lahaxearnaud/laravel-token"><img src="https://travis-ci.org/lahaxearnaud/laravel-token.svg?branch=develop" alt="Build Status"></a>
<a href="https://insight.sensiolabs.com/projects/2f9abd1c-42a6-4a80-88f4-e1687b1d361a"><img src="https://insight.sensiolabs.com/projects/2f9abd1c-42a6-4a80-88f4-e1687b1d361a/mini.png" alt="SensioLabsInsight"></a>
<a href="https://codeclimate.com/github/lahaxearnaud/laravel-token"><img src="https://d3s6mut3hikguw.cloudfront.net/github/lahaxearnaud/laravel-token/badges/gpa.svg" alt="CodeClimat"></a>
<a href="https://codeclimate.com/github/lahaxearnaud/laravel-token"><img src="https://codeclimate.com/github/lahaxearnaud/laravel-token/badges/coverage.svg" alt="Test Coverage"></a>
<a href="https://github.com/lahaxearnaud/laravel-token"><img src="https://poser.pugx.org/leaphly/cart-bundle/license.svg" alt="License"></a></p>

<h2>
<a id="table-of-contents" class="anchor" href="#table-of-contents" aria-hidden="true"><span class="octicon octicon-link"></span></a>Table of Contents</h2>

<ul>
<li>
<a href="#installation">Installation</a>

<ul>
<li><a href="#database">Database</a></li>
<li><a href="#provider">Provider</a></li>
<li><a href="#facade">Facade</a></li>
</ul>
</li>
<li>
<a href="#usage">Usage</a>

<ul>
<li><a href="#create-token">Create token</a></li>
<li><a href="#crypt-token">Crypt token</a></li>
<li><a href="#validate-token">Validate token</a></li>
<li><a href="#route-filter">Route filter</a></li>
<li><a href="#exceptions">Exceptions</a></li>
<li><a href="#events">Events</a></li>
</ul>
</li>
<li>
<a href="#commands">Commands</a>

<ul>
<li><a href="#delete-expired-tokens">Delete expired tokens</a></li>
<li><a href="#truncate-the-table">Truncate the table</a></li>
</ul>
</li>
<li>
<a href="#api">API</a>

<ul>
<li><a href="#security">Security</a></li>
<li><a href="#creation">Creation</a></li>
<li><a href="#deletion">Deletion</a></li>
<li><a href="#validation">Validation</a></li>
<li><a href="#find">Find</a></li>
</ul>
</li>
</ul>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h2>

<div class="highlight highlight-json"><pre>{
    <span class="pl-s1"><span class="pl-pds">"</span>require<span class="pl-pds">"</span></span>: {
        <span class="pl-s1"><span class="pl-pds">"</span>lahaxearnaud/laravel-token<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>~0.5<span class="pl-pds">"</span></span>
    }
}</pre></div>

<h3>
<a id="database" class="anchor" href="#database" aria-hidden="true"><span class="octicon octicon-link"></span></a>Database</h3>

<div class="highlight highlight-bash"><pre>    $ php artisan migrate --package=<span class="pl-s1"><span class="pl-pds">"</span>lahaxearnaud/laravel-token<span class="pl-pds">"</span></span></pre></div>

<h3>
<a id="provider" class="anchor" href="#provider" aria-hidden="true"><span class="octicon octicon-link"></span></a>Provider</h3>

<div class="highlight highlight-php"><pre><span class="pl-s2">    <span class="pl-s1"><span class="pl-pds">'</span>providers<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s3">array</span>(</span>
<span class="pl-s2">        <span class="pl-c">// ...</span></span>
<span class="pl-s2">        <span class="pl-s1"><span class="pl-pds">'</span>Lahaxearnaud\LaravelToken\LaravelTokenServiceProvider<span class="pl-pds">'</span></span>,</span>
<span class="pl-s2">    ),</span></pre></div>

<h3>
<a id="facade" class="anchor" href="#facade" aria-hidden="true"><span class="octicon octicon-link"></span></a>Facade</h3>

<div class="highlight highlight-php"><pre><span class="pl-s2">    <span class="pl-s1"><span class="pl-pds">'</span>aliases<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s3">array</span>(</span>
<span class="pl-s2">        <span class="pl-c">// ...</span></span>
<span class="pl-s2">        <span class="pl-s1"><span class="pl-pds">'</span>Token<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s1"><span class="pl-pds">'</span>Lahaxearnaud\LaravelToken\LaravelTokenFacade<span class="pl-pds">'</span></span>,</span>
<span class="pl-s2">    ),</span></pre></div>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h2>

<h3>
<a id="create-token" class="anchor" href="#create-token" aria-hidden="true"><span class="octicon octicon-link"></span></a>Create token</h3>

<div class="highlight highlight-php"><pre><span class="pl-s2">    <span class="pl-vo">$token</span> <span class="pl-k">=</span> <span class="pl-s3">Token</span><span class="pl-k">::</span>create(<span class="pl-vo">$userID</span>, <span class="pl-vo">$allowLogin</span>);</span></pre></div>

<p>If <code>$allowLogin</code> is set to true the token can be use to authentification via route filter.</p>

<h3>
<a id="crypt-token" class="anchor" href="#crypt-token" aria-hidden="true"><span class="octicon octicon-link"></span></a>Crypt token</h3>

<div class="highlight highlight-php"><pre><span class="pl-s2">    <span class="pl-vo">$token</span> <span class="pl-k">=</span> <span class="pl-s3">Token</span><span class="pl-k">::</span>create(<span class="pl-vo">$userID</span>, <span class="pl-vo">$allowLogin</span>);</span>
<span class="pl-s2">    <span class="pl-vo">$cryptToken</span> <span class="pl-k">=</span> <span class="pl-s3">Token</span><span class="pl-k">::</span>cryptToken(<span class="pl-vo">$token</span><span class="pl-k">-&gt;</span><span class="pl-vo">token</span>);</span></pre></div>

<p>If <code>$allowLogin</code> is set to true the token can be use to authentification via route filter.</p>

<h3>
<a id="validate-token" class="anchor" href="#validate-token" aria-hidden="true"><span class="octicon octicon-link"></span></a>Validate token</h3>

<p>If you crypt your token</p>

<div class="highlight highlight-php"><pre><span class="pl-s2">    <span class="pl-vo">$tokenStr</span> <span class="pl-k">=</span> <span class="pl-s3">Token</span><span class="pl-k">::</span>getTokenValueFromRequest();</span>
<span class="pl-s2"></span>
<span class="pl-s2">    <span class="pl-vo">$cryptToken</span> <span class="pl-k">=</span> <span class="pl-s3">Token</span><span class="pl-k">::</span>isValidCryptToken(<span class="pl-vo">$token</span><span class="pl-k">-&gt;</span><span class="pl-vo">token</span>, <span class="pl-vo">$userId</span>);</span></pre></div>

<p>If you don't crypt your token:</p>

<div class="highlight highlight-php"><pre><span class="pl-s2">    <span class="pl-vo">$tokenStr</span> <span class="pl-k">=</span> <span class="pl-s3">Token</span><span class="pl-k">::</span>getTokenValueFromRequest();</span>
<span class="pl-s2"></span>
<span class="pl-s2">    <span class="pl-vo">$cryptToken</span> <span class="pl-k">=</span> <span class="pl-s3">Token</span><span class="pl-k">::</span>isValidToken(<span class="pl-vo">$token</span><span class="pl-k">-&gt;</span><span class="pl-vo">token</span>, <span class="pl-vo">$userId</span>);</span></pre></div>

<p>If you use those functions the token is not burn. It can be use many times.</p>

<p>For one shot usage token:</p>

<div class="highlight highlight-php"><pre><span class="pl-s2">    <span class="pl-vo">$tokenStr</span> <span class="pl-k">=</span> <span class="pl-s3">Token</span><span class="pl-k">::</span>getTokenValueFromRequest();</span>
<span class="pl-s2"></span>
<span class="pl-s2">    <span class="pl-c">/**</span></span>
<span class="pl-s2"><span class="pl-c">      * if the token is crypt do :</span></span>
<span class="pl-s2"><span class="pl-c">      * $tokenStr = Token::uncryptToken($tokenStr);</span></span>
<span class="pl-s2"><span class="pl-c">    **/</span></span>
<span class="pl-s2"></span>
<span class="pl-s2">    <span class="pl-vo">$tokenValid</span> <span class="pl-k">=</span> <span class="pl-c1">true</span>;</span>
<span class="pl-s2">    <span class="pl-k">try</span> {</span>
<span class="pl-s2">        <span class="pl-c">// find the token</span></span>
<span class="pl-s2">        <span class="pl-vo">$token</span> <span class="pl-k">=</span> <span class="pl-vo">$token</span><span class="pl-k">-&gt;</span>findByToken(<span class="pl-vo">$tokenStr</span>, <span class="pl-vo">$userId</span>);</span>
<span class="pl-s2"></span>
<span class="pl-s2">        <span class="pl-c">// test the token validity</span></span>
<span class="pl-s2">        <span class="pl-k">if</span> (<span class="pl-s3">Token</span><span class="pl-k">::</span>isValidToken(<span class="pl-vo">$token</span>)) {</span>
<span class="pl-s2"></span>
<span class="pl-s2">            <span class="pl-c">// do what you need to do</span></span>
<span class="pl-s2"></span>
<span class="pl-s2">            <span class="pl-c">// delete the token</span></span>
<span class="pl-s2">            <span class="pl-s3">Token</span><span class="pl-k">::</span>burn(<span class="pl-vo">$token</span>);</span>
<span class="pl-s2">        } <span class="pl-k">else</span> {</span>
<span class="pl-s2">            <span class="pl-vo">$tokenValid</span> <span class="pl-k">=</span> <span class="pl-c1">false</span>;</span>
<span class="pl-s2">        }</span>
<span class="pl-s2">    } <span class="pl-k">catch</span> (<span class="pl-s3">TokenNotFoundException</span> <span class="pl-vo">$e</span>) {</span>
<span class="pl-s2">        <span class="pl-vo">$tokenValid</span> <span class="pl-k">=</span> <span class="pl-c1">false</span>;</span>
<span class="pl-s2">    }</span>
<span class="pl-s2"></span>
<span class="pl-s2">    <span class="pl-k">if</span>(<span class="pl-vo">$tokenValid</span>) {</span>
<span class="pl-s2">        <span class="pl-c">// manage errors</span></span>
<span class="pl-s2">    }</span></pre></div>

<h3>
<a id="route-filter" class="anchor" href="#route-filter" aria-hidden="true"><span class="octicon octicon-link"></span></a>Route filter</h3>

<p>Simple token protection:</p>

<div class="highlight highlight-php"><pre><span class="pl-s2">    <span class="pl-s3">Route</span><span class="pl-k">::</span>get(<span class="pl-s1"><span class="pl-pds">'</span>/token-protected<span class="pl-pds">'</span></span>, <span class="pl-s3">array</span>(<span class="pl-s1"><span class="pl-pds">'</span>before<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s1"><span class="pl-pds">'</span>token<span class="pl-pds">'</span></span>, <span class="pl-st">function</span> () {</span>
<span class="pl-s2">        <span class="pl-s3">echo</span> <span class="pl-s1"><span class="pl-pds">"</span>I am token protected<span class="pl-pds">"</span></span>;</span>
<span class="pl-s2">    }));</span></pre></div>

<p>Authentification by token:</p>

<p>The token used for an authentification must be a login token, pleaserefer to the token creation section</p>

<div class="highlight highlight-php"><pre><span class="pl-s2">    <span class="pl-s3">Route</span><span class="pl-k">::</span>get(<span class="pl-s1"><span class="pl-pds">'</span>/login-by-token<span class="pl-pds">'</span></span>, <span class="pl-s3">array</span>(<span class="pl-s1"><span class="pl-pds">'</span>before<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s1"><span class="pl-pds">'</span>token.auth<span class="pl-pds">'</span></span>, <span class="pl-st">function</span> () {</span>
<span class="pl-s2">        <span class="pl-s3">echo</span> <span class="pl-s3">Auth</span><span class="pl-k">::</span>user()<span class="pl-k">-&gt;</span><span class="pl-vo">username</span>;</span>
<span class="pl-s2">    }));</span></pre></div>

<p>In order to use the authentification by token your class User need to implements <code>Lahaxearnaud\LaravelToken\Models\UserTokenInterface</code></p>

<div class="highlight highlight-php"><pre><span class="pl-s2"></span>
<span class="pl-s2"><span class="pl-k">use</span> <span class="pl-s3">Illuminate\Auth\UserTrait</span>;</span>
<span class="pl-s2"><span class="pl-k">use</span> <span class="pl-s3">Illuminate\Auth\UserInterface</span>;</span>
<span class="pl-s2"><span class="pl-k">use</span> <span class="pl-s3">Illuminate\Auth\Reminders\RemindableTrait</span>;</span>
<span class="pl-s2"><span class="pl-k">use</span> <span class="pl-s3">Illuminate\Auth\Reminders\RemindableInterface</span>;</span>
<span class="pl-s2"><span class="pl-k">use</span> <span class="pl-s3">Lahaxearnaud\LaravelToken\Models\UserTokenInterface</span>;</span>
<span class="pl-s2"></span>
<span class="pl-s2"><span class="pl-st">class</span> <span class="pl-en">User</span> <span class="pl-s">extends</span> <span class="pl-e">Eloquent</span> <span class="pl-s">implements</span> <span class="pl-e">UserInterface</span>, <span class="pl-e">RemindableInterface</span>, <span class="pl-e">UserTokenInterface</span> {</span>
<span class="pl-s2"></span>
<span class="pl-s2">    <span class="pl-k">use</span> <span class="pl-s3">UserTrait</span>, <span class="pl-s3">RemindableTrait</span>;</span>
<span class="pl-s2"></span>
<span class="pl-s2">    <span class="pl-c">/**</span></span>
<span class="pl-s2"><span class="pl-c">     * The database table used by the model.</span></span>
<span class="pl-s2"><span class="pl-c">     *</span></span>
<span class="pl-s2"><span class="pl-c">     * <span class="pl-k">@var</span> string</span></span>
<span class="pl-s2"><span class="pl-c">     */</span></span>
<span class="pl-s2">    <span class="pl-s">protected</span> <span class="pl-vo">$table</span> <span class="pl-k">=</span> <span class="pl-s1"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>;</span>
<span class="pl-s2"></span>
<span class="pl-s2">    <span class="pl-c">/**</span></span>
<span class="pl-s2"><span class="pl-c">     * The attributes excluded from the model's JSON form.</span></span>
<span class="pl-s2"><span class="pl-c">     *</span></span>
<span class="pl-s2"><span class="pl-c">     * <span class="pl-k">@var</span> array</span></span>
<span class="pl-s2"><span class="pl-c">     */</span></span>
<span class="pl-s2">    <span class="pl-s">protected</span> <span class="pl-vo">$hidden</span> <span class="pl-k">=</span> <span class="pl-s3">array</span>(<span class="pl-s1"><span class="pl-pds">'</span>password<span class="pl-pds">'</span></span>, <span class="pl-s1"><span class="pl-pds">'</span>remember_token<span class="pl-pds">'</span></span>);</span>
<span class="pl-s2"></span>
<span class="pl-s2">    <span class="pl-s">public</span> <span class="pl-st">function</span> <span class="pl-en">loggableByToken</span>()</span>
<span class="pl-s2">    {</span>
<span class="pl-s2">        <span class="pl-k">return</span> <span class="pl-c1">true</span>;</span>
<span class="pl-s2">    }</span>
<span class="pl-s2">}</span></pre></div>

<p>The method <code>loggableByToken</code> is called when a user try to authentificate with a token.</p>

<p>If an error occur on token validation a TokenExeption is throw, please go to <a href="#exceptions">Exceptions</a> section. </p>

<p>By default you can send your token in parameter or header. The default name of the field is <code>token</code> but you 
can change it by publishing and change the configuration:</p>

<div class="highlight highlight-bash"><pre>    $ php artisan config:publish lahaxearnaud/laravel-token</pre></div>

<p>Then change the tokenFieldName <code>config/packages/lahaxearnaud/laravel-token/config.php</code>.</p>

<p>You can get the token instance via:</p>

<div class="highlight highlight-php"><pre><span class="pl-s2">    <span class="pl-s3">Token</span><span class="pl-k">::</span>getCurrentToken();</span></pre></div>

<h3>
<a id="exceptions" class="anchor" href="#exceptions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exceptions</h3>

<p>If you use route filter you need to handle some Exceptions. Add the following error handler in you <code>filter.php</code> to catch them.
This is basic example, change the behavior to fit your needs (redirect, log...).</p>

<div class="highlight highlight-php"><pre><span class="pl-s2">    <span class="pl-s3">App</span><span class="pl-k">::</span>error(<span class="pl-st">function</span>(<span class="pl-s3">\Lahaxearnaud\LaravelToken\exeptions\</span><span class="pl-s3">TokenException</span> <span class="pl-vo">$exception</span>)</span>
<span class="pl-s2">    {</span>
<span class="pl-s2">        <span class="pl-k">if</span>(<span class="pl-vo">$exception</span> <span class="pl-k">instanceof</span> <span class="pl-s3">\Lahaxearnaud\LaravelToken\exeptions\</span><span class="pl-s3">TokenNotFoundException</span>) {</span>
<span class="pl-s2">            <span class="pl-k">return</span> <span class="pl-s3">\</span><span class="pl-s3">Response</span><span class="pl-k">::</span>make(<span class="pl-s1"><span class="pl-pds">'</span>Unauthorized (Not found)<span class="pl-pds">'</span></span>, <span class="pl-c1">401</span>);</span>
<span class="pl-s2">        }</span>
<span class="pl-s2"></span>
<span class="pl-s2">        <span class="pl-k">if</span>(<span class="pl-vo">$exception</span> <span class="pl-k">instanceof</span> <span class="pl-s3">\Lahaxearnaud\LaravelToken\exeptions\</span><span class="pl-s3">TokenNotValidException</span>) {</span>
<span class="pl-s2">            <span class="pl-k">return</span> <span class="pl-s3">\</span><span class="pl-s3">Response</span><span class="pl-k">::</span>make(<span class="pl-s1"><span class="pl-pds">'</span>Unauthorized (Not valid token)<span class="pl-pds">'</span></span>, <span class="pl-c1">401</span>);</span>
<span class="pl-s2">        }</span>
<span class="pl-s2"></span>
<span class="pl-s2">        <span class="pl-k">if</span>(<span class="pl-vo">$exception</span> <span class="pl-k">instanceof</span> <span class="pl-s3">\Lahaxearnaud\LaravelToken\exeptions\</span><span class="pl-s3">UserNotLoggableByTokenException</span>) {</span>
<span class="pl-s2">            <span class="pl-k">return</span> <span class="pl-s3">\</span><span class="pl-s3">Response</span><span class="pl-k">::</span>make(<span class="pl-s1"><span class="pl-pds">'</span>Unauthorized (Not loggable by token)<span class="pl-pds">'</span></span>, <span class="pl-c1">401</span>);</span>
<span class="pl-s2">        }</span>
<span class="pl-s2"></span>
<span class="pl-s2">        <span class="pl-k">if</span>(<span class="pl-vo">$exception</span> <span class="pl-k">instanceof</span> <span class="pl-s3">\Lahaxearnaud\LaravelToken\exeptions\</span><span class="pl-s3">NotLoginTokenException</span>) {</span>
<span class="pl-s2">            <span class="pl-k">return</span> <span class="pl-s3">\</span><span class="pl-s3">Response</span><span class="pl-k">::</span>make(<span class="pl-s1"><span class="pl-pds">'</span>Unauthorized (Not login token)<span class="pl-pds">'</span></span>, <span class="pl-c1">401</span>);</span>
<span class="pl-s2">        }</span>
<span class="pl-s2">    });</span></pre></div>

<h3>
<a id="events" class="anchor" href="#events" aria-hidden="true"><span class="octicon octicon-link"></span></a>Events</h3>

<p>You can listen events:</p>

<ul>
<li>Token not found

<ul>
<li>name: <code>token.notFound</code> </li>
<li>parameters:

<ul>
<li>the token string</li>
</ul>
</li>
</ul>
</li>
<li>Token not valid

<ul>
<li>name: <code>token.notValid</code>
</li>
<li>parameters:

<ul>
<li>the token object</li>
</ul>
</li>
</ul>
</li>
<li>Token doesn't allow to be used for login

<ul>
<li>name: <code>token.notLoginToken</code>
</li>
<li>parameters:

<ul>
<li>the token object</li>
</ul>
</li>
</ul>
</li>
<li>The user can't logged with a token

<ul>
<li>name: <code>token.notLoggableUser</code>
</li>
<li>parameters:

<ul>
<li>the token object</li>
<li>the user object</li>
</ul>
</li>
</ul>
</li>
<li>Token burn

<ul>
<li>name: <code>token.burned</code>
</li>
<li>parameters:

<ul>
<li>the token object</li>
</ul>
</li>
</ul>
</li>
<li>Token created

<ul>
<li>name: <code>token.created</code>
</li>
<li>parameters:

<ul>
<li>the token object</li>
</ul>
</li>
</ul>
</li>
<li>Token saved

<ul>
<li>name: <code>token.saved</code>
</li>
<li>parameters:

<ul>
<li>the token object</li>
</ul>
</li>
</ul>
</li>
</ul>

<h2>
<a id="commands" class="anchor" href="#commands" aria-hidden="true"><span class="octicon octicon-link"></span></a>Commands</h2>

<pre><code>A new artisan command is added to your project in order to help you to clean your token table

### Delete expired tokens
    Without any option the command delete all expired tokens.
    ```bash
        $ php artisan token:clean
    ```
### Truncate the table
    If you specified ``--all`` all token will be deleted
    ```bash
        $ php artisan token:clean -all
    ```
</code></pre>

<h2>
<a id="api" class="anchor" href="#api" aria-hidden="true"><span class="octicon octicon-link"></span></a>API</h2>

<h3>
<a id="security" class="anchor" href="#security" aria-hidden="true"><span class="octicon octicon-link"></span></a>Security</h3>

<p>Crypt a string token in order to get a public token</p>

<div class="highlight highlight-php"><pre><span class="pl-s2">    <span class="pl-s3">Token</span><span class="pl-k">::</span>cryptToken (<span class="pl-vo">$uncrypt</span>)</span></pre></div>

<p>Uncrypt a public token in order to get the private token</p>

<div class="highlight highlight-php"><pre><span class="pl-s2">    <span class="pl-s3">Token</span><span class="pl-k">::</span>uncryptToken (<span class="pl-vo">$crypt</span>)</span></pre></div>

<h3>
<a id="creation" class="anchor" href="#creation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Creation</h3>

<p>Create a Token instance (directly saved in database)</p>

<div class="highlight highlight-php"><pre><span class="pl-s2">    <span class="pl-s3">Token</span><span class="pl-k">::</span>create (<span class="pl-vo">$userId</span>, <span class="pl-vo">$allowLogin</span> <span class="pl-k">=</span> <span class="pl-c1">false</span>, <span class="pl-vo">$lifetime</span> <span class="pl-k">=</span> <span class="pl-c1">3600</span>, <span class="pl-vo">$length</span> <span class="pl-k">=</span> <span class="pl-c1">100</span>)</span></pre></div>

<p>If <code>$allowLogin</code> is set to true the token can be use to authentification via route filter.</p>

<h3>
<a id="deletion" class="anchor" href="#deletion" aria-hidden="true"><span class="octicon octicon-link"></span></a>Deletion</h3>

<p>Delete the token</p>

<div class="highlight highlight-php"><pre><span class="pl-s2">    <span class="pl-s3">Token</span><span class="pl-k">::</span>burn (<span class="pl-c1">Token</span> <span class="pl-vo">$token</span>)</span></pre></div>

<h3>
<a id="validation" class="anchor" href="#validation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Validation</h3>

<p>Fetch the token, check id the token has the good user ID and if it is not expired</p>

<div class="highlight highlight-php"><pre><span class="pl-s2">    <span class="pl-s3">Token</span><span class="pl-k">::</span>isValidToken (<span class="pl-vo">$token</span>, <span class="pl-vo">$userId</span>)</span></pre></div>

<p>Same as isValidToken but uncrypt the token before trying to find him</p>

<div class="highlight highlight-php"><pre><span class="pl-s2">    <span class="pl-s3">Token</span><span class="pl-k">::</span>isValidCryptToken (<span class="pl-vo">$token</span>, <span class="pl-vo">$userId</span>)</span></pre></div>

<p>Only validate if the token is expired</p>

<div class="highlight highlight-php"><pre><span class="pl-s2">    <span class="pl-s3">Token</span><span class="pl-k">::</span>isValid (<span class="pl-c1">Token</span> <span class="pl-vo">$token</span>)</span></pre></div>

<h3>
<a id="find" class="anchor" href="#find" aria-hidden="true"><span class="octicon octicon-link"></span></a>Find</h3>

<p>Find the token by ID</p>

<div class="highlight highlight-php"><pre><span class="pl-s2">    <span class="pl-s3">Token</span><span class="pl-k">::</span>find (<span class="pl-vo">$id</span>)</span></pre></div>

<p>Find the token by token string</p>

<div class="highlight highlight-php"><pre><span class="pl-s2">    <span class="pl-s3">Token</span><span class="pl-k">::</span>findByToken (<span class="pl-vo">$token</span>, <span class="pl-vo">$userId</span>)</span></pre></div>

<p>Find all token for an user</p>

<div class="highlight highlight-php"><pre><span class="pl-s2">    <span class="pl-s3">Token</span><span class="pl-k">::</span>findByUser (<span class="pl-vo">$idUser</span>)</span></pre></div>

<h2>
<a id="todo" class="anchor" href="#todo" aria-hidden="true"><span class="octicon octicon-link"></span></a>Todo</h2>

<ul>
<li>token type</li>
<li>config to allow only one token by user and type</li>
</ul>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/lahaxearnaud/laravel-token/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/lahaxearnaud/laravel-token/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/lahaxearnaud/laravel-token"></a> is maintained by <a href="https://github.com/lahaxearnaud">lahaxearnaud</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>
